var w=0,I=!1,c=null;function x(t){for(let r in t)if(typeof t[r]!="function")throw new Error("actions \u91CC\u53EA\u80FD\u653E\u51FD\u6570")}function k(t){if(t===null||typeof t!="object")throw new Error("state \u5FC5\u987B\u662F\u5BF9\u8C61")}function d(t){return(r,n)=>{let o=t[r];o||(o=t[r]=new Set),o.add(n)}}function g(t){return(r,n)=>{t[r].delete(n)}}function y(t,r){let{trackStore:n}=t,o=t.state[r],s=n[r];if(!!s)for(let e of s)e(o)}function h(t,r){let{state:n,actions:o}=t;return new Proxy(t,{get(s,e){if(e in r)return r[e];if(e in n)return n[e];if(e in o)return o[e];throw new Error(`\u6CA1\u6709\u627E\u5230 ${e}`)},set(s,e,a){if(e in r)throw new Error(`${e} \u662F\u7CFB\u7EDF\u65B9\u6CD5\u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`);if(e in n)return n[e]=a,!0;throw e in o?new Error(`${e} \u662F actions \u7684\u65B9\u6CD5, \u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`):new Error(`${e} \u8BF7\u5728\u521B\u5EFA Store \u65F6\u6DFB\u52A0\u5230 State \u6216 Actions \u4E2D`)}})}function l(t,r,n=null){return new Proxy(r,{set(o,s,e){return o[s]===e?!1:I?o[s]=e:(typeof e=="object"&&e!==null?(c=n||s,o[s]=A(t,e),c=null):o[s]=e,n?y(t,n):y(t,s),!0)}})}function A(t,r,n=!1){let o={};Array.isArray(r)&&(o=[]),I=!0;function s(e,a,S=!1){for(let f in e){let i=e[f];if(S&&(c=f),typeof i=="object"&&i!==null){let u={};Array.isArray(i)&&(u=[]),s(i,u),a[f]=l(t,u,c)}else a[f]=i;S&&(c=null)}}return s(r,o,n),I=!1,n?l(t,o):l(t,o,c)}function P(t,r){let n={id:w++,trackStore:{},state:{},actions:r};return n.state=A(n,t,!0),n}function E(t){let{trackStore:r}=t;return{watch:d(r),deleteWatch:g(r)}}function b(t){let r=t.state??{},n=t.actions??{};k(r),x(n);let o=P(r,n),s=E(o);return h(o,s)}export{b as default};
