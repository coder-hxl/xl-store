"use strict";var w=0,S=!1,s=null;function x(t){for(let r in t)if(typeof t[r]!="function")throw new Error("actions \u91CC\u53EA\u80FD\u653E\u51FD\u6570")}function k(t){if(t===null||typeof t!="object")throw new Error("state \u5FC5\u987B\u662F\u5BF9\u8C61")}function d(t){return(r,n)=>{let c=t[r];c||(c=t[r]=new Set),c.add(n)}}function b(t){return(r,n)=>{let c=t[r];!c||c.delete(n)}}function A(t,r){let{trackStore:n}=t,c=t.state[r],o=n[r];if(!!o)for(let e of o)e(c)}function h(t,r){let{state:n,actions:c}=t;return new Proxy(t,{get(o,e){if(e in r)return r[e];if(e in n)return n[e];if(e in c)return c[e];throw new Error(`\u6CA1\u6709\u627E\u5230 ${e}`)},set(o,e,i){if(e in r)throw new Error(`${e} \u662F Store \u81EA\u5E26\u7684\u65B9\u6CD5\u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`);if(e in n)return n[e]=i,!0;throw e in c?new Error(`${e} \u662F actions \u7684\u65B9\u6CD5, \u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`):new Error(`${e} \u8BF7\u5728\u521B\u5EFA Store \u65F6\u6DFB\u52A0\u5230 State \u6216 Actions \u4E2D`)}})}function l(t,r,n=null){return new Proxy(r,{set(c,o,e){return c[o]===e?!1:S?(c[o]=e,!0):(typeof e=="object"&&e!==null?(s=n||o,c[o]=y(t,e),s=null):c[o]=e,n?A(t,n):A(t,o),!0)}})}function y(t,r,n=!1){let c={};Array.isArray(r)&&(c=[]),S=!0;function o(e,i,a=!1){for(let u in e){let f=e[u];if(a&&(s=u),typeof f=="object"&&f!==null){let I={};Array.isArray(f)&&(I=[]),o(f,I),i[u]=l(t,I,s)}else i[u]=f;a&&(s=null)}}return o(r,c,n),S=!1,n?l(t,c):l(t,c,s)}function j(t,r){let n={id:w++,trackStore:{},state:{},actions:r};return n.state=y(n,t,!0),n}function P(t){let{trackStore:r}=t;return{watch:d(r),deleteWatch:b(r)}}function g(t){var i,a;let r=(i=t.state)!=null?i:{},n=(a=t.actions)!=null?a:{};k(r),x(n);let c=j(r,n),o=P(c);return h(c,o)}module.exports=g;
