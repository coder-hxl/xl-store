"use strict";var x=0,S=!1,u=null;function d(t){for(let i in t)if(typeof t[i]!="function")throw new Error("actions \u91CC\u53EA\u80FD\u653E\u51FD\u6570")}function g(t){if(t===null||typeof t!="object")throw new Error("state \u5FC5\u987B\u662F\u5BF9\u8C61")}function A(t,i=!1){function r(n,o){if(i){let c=t.state[n];o(n,c)}let e=t.trackStore,s=e[n];s||(s=e[n]=new Set),s.add(o)}return(n,o)=>{if(Array.isArray(n))for(let e of n)r(e,o);else r(n,o)}}function k(t){function i(r,n){let o=t[r];!o||o.delete(n)}return(r,n)=>{if(Array.isArray(r))for(let o of r)i(o,n);else i(r,n)}}function y(t,i){let{trackStore:r}=t,n=t.state[i],o=r[i];if(!!o)for(let e of o)e(i,n)}function h(t,i){let{state:r,actions:n}=t;return new Proxy(t,{get(o,e){if(e in i)return i[e];if(e in r)return r[e];if(e in n)return n[e];throw new Error(`\u6CA1\u6709\u627E\u5230 ${e}`)},set(o,e,s){if(e in i)throw new Error(`${e} \u662F Store \u81EA\u5E26\u7684\u65B9\u6CD5\u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`);if(e in r)return r[e]=s,!0;throw e in n?new Error(`${e} \u662F actions \u7684\u65B9\u6CD5, \u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`):new Error(`${e} \u8BF7\u5728\u521B\u5EFA Store \u65F6\u6DFB\u52A0\u5230 State \u6216 Actions \u4E2D`)}})}function l(t,i,r=null){let{sameValueExecuteWatch:n}=t.options;return new Proxy(i,{set(o,e,s){return!n&&o[e]===s?!0:S?(o[e]=s,!0):(typeof s=="object"&&s!==null?(u=r||e,o[e]=w(t,s),u=null):o[e]=s,r?y(t,r):y(t,e),!0)}})}function w(t,i,r=!1){let n={};Array.isArray(i)&&(n=[]),S=!0;function o(e,s,c=!1){for(let f in e){let a=e[f];if(c&&(u=f),typeof a=="object"&&a!==null){let I={};Array.isArray(a)&&(I=[]),o(a,I),s[f]=l(t,I,u)}else s[f]=a;c&&(u=null)}}return o(i,n,r),S=!1,r?l(t,n):l(t,n,u)}function j(t,i,r){let n={id:x++,trackStore:{},state:{},actions:i,options:r};return n.state=w(n,t,!0),n}function E(t){let{trackStore:i}=t;return{watch:A(t),watchEffect:A(t,!0),deleteWatch:k(i)}}function O(t,i={}){var c,f;let r=(c=t.state)!=null?c:{},n=(f=t.actions)!=null?f:{};g(r),d(n);let o=j(r,n,i),e=E(o);return h(o,e)}module.exports=O;
