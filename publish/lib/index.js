"use strict";function p(t){for(let r in t)if(typeof t[r]!="function")throw new Error("actions \u91CC\u53EA\u80FD\u653E\u51FD\u6570")}function O(t){if(t===null||typeof t!="object")throw new Error("state \u5FC5\u987B\u662F\u5BF9\u8C61")}function l(t){let{state:r={},actions:e={}}=t;O(r),p(e)}function f(t,r=!1){function e(s,o){if(r){let i=t.state[s];o(s,i)}let n=t.trackStore,c=n[s];c||(c=n[s]=new Set),c.add(o)}return(s,o)=>{if(Array.isArray(s))for(let n of s)e(n,o);else e(s,o)}}function d({trackStore:t}){function r(e,s){let o=t[e];!o||o.delete(s)}return(e,s)=>{if(Array.isArray(e))for(let o of e)r(o,s);else r(e,s)}}function P(t,r){let{trackStore:e}=t,s=t.state[r],o=e[r];if(!!o)for(let n of o)n(r,s)}var x=!1,I=null;function m(t){let{state:r,actions:e,storeApi:s}=t;return new Proxy(t,{get(o,n){return n in s?s[n]:n in r?r[n]:n in e?e[n]:void 0},set(o,n,c){if(n in s)throw new Error(`${n} \u662F Store \u81EA\u5E26\u7684\u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`);if(n in r)return r[n]=c,!0;throw n in e?new Error(`${n} \u662F actions , \u4E0D\u5141\u8BB8\u5728\u6B64\u88AB\u4FEE\u6539`):new Error(`${n} \u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539\u6216\u6DFB\u52A0`)}})}function a(t,r,e=null){let{isDeepWatch:s}=t.options;return new Proxy(r,{set(o,n,c){if(o[n]===c)return!0;if(s){if(x)return o[n]=c,!0;typeof c=="object"&&c!==null?(I=e!=null?e:n,o[n]=y(t,c),I=null):o[n]=c}else o[n]=c;return P(t,e!=null?e:n),!0}})}function y(t,r,e=!1){let s=Array.isArray(r)?[]:{};function o(n,c,i=!1){for(let S in n){let A=n[S];if(i&&(I=S),typeof A=="object"&&A!==null){let u=Array.isArray(A)?[]:{};o(A,u),c[S]=a(t,u,I)}else c[S]=A;i&&(I=null)}}return x=!0,o(r,s,e),x=!1,a(t,s,e?null:I)}var g=0;function j(t,r){let{isDeepWatch:e}=t.options,s=e?y(t,r,!0):a(t,r);t.state=s}function w(t){let r={watch:f(t),watchEffect:f(t,!0),deleteWatch:d(t)};t.storeApi=r}function R(t,r={}){let{state:e={},actions:s={}}=t,o={id:g++,trackStore:{},storeApi:{},state:{},actions:s,options:r};return w(o),j(o,e),o}function b(t,r){l(t);let e=R(t,r);return m(e)}module.exports=b;
