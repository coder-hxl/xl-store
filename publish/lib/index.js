"use strict";function f(t,o=!1){function e(n,s){if(o){let c=t.state[n];s(n,c)}let i=t.trackStore,r=i[n];r||(r=i[n]=new Set),r.add(s)}return(n,s)=>{if(Array.isArray(n))for(let i of n)e(i,s);else e(n,s)}}function l({trackStore:t}){function o(e,n){let s=t[e];!s||s.delete(n)}return(e,n)=>{if(Array.isArray(e))for(let s of e)o(s,n);else o(e,n)}}function d(t,o){let{trackStore:e}=t,n=t.state[o],s=e[o];if(!!s)for(let i of s)i(o,n)}var u=!1,A=null;function m(t,o){let{state:e,actions:n}=t;return new Proxy(t,{get(i,r){if(r in t)return t[r];if(r in o)return o[r];if(r in e)return e[r];if(r in n)return n[r];throw new Error(`\u4E0D\u80FD\u83B7\u53D6 ${r}`)},set(i,r,c){if(r in o)throw new Error(`${r} \u662F Store \u81EA\u5E26\u7684\u65B9\u6CD5\u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`);if(r in e)return e[r]=c,!0;throw r in n?new Error(`${r} \u662F actions \u7684\u65B9\u6CD5, \u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`):new Error(`${r} \u8BF7\u5728\u521B\u5EFA Store \u65F6\u6DFB\u52A0\u5230 State \u6216 Actions \u4E2D`)}})}function I(t,o,e=null){let{isDeepWatch:n}=t.options;return new Proxy(o,{set(s,i,r){if(s[i]===r)return!0;if(!n)s[i]=r;else{if(n&&u)return s[i]=r,!0;n&&typeof r=="object"&&r!==null&&(A=e!=null?e:i,s[i]=x(t,r),A=null)}return d(t,e!=null?e:i),!0}})}function x(t,o,e=!1){let n=Array.isArray(o)?[]:{};function s(i,r,c=!1){for(let S in i){let a=i[S];if(c&&(A=S),typeof a=="object"&&a!==null){let y=Array.isArray(a)?[]:{};s(a,y),r[S]=I(t,y,A)}else r[S]=a;c&&(A=null)}}return u=!0,s(o,n,e),u=!1,I(t,n,e?null:A)}var h=0;function p(t,o){let{isDeepWatch:e}=t.options;return e?x(t,o,!0):I(t,o)}function O(t,o,e){let n={id:h++,trackStore:{},state:{},actions:o,options:e};return n.state=p(n,t),n}function j(t){return{watch:f(t),watchEffect:f(t,!0),deleteWatch:l(t)}}function w(t){for(let o in t)if(typeof t[o]!="function")throw new Error("actions \u91CC\u53EA\u80FD\u653E\u51FD\u6570")}function b(t){if(t===null||typeof t!="object")throw new Error("state \u5FC5\u987B\u662F\u5BF9\u8C61")}function g(t,o={}){var c,S;let e=(c=t.state)!=null?c:{},n=(S=t.actions)!=null?S:{};b(e),w(n);let s=O(e,n,o),i=j(s);return m(s,i)}module.exports=g;
