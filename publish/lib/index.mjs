var w=0,S=!1,f=null;function x(e){for(let o in e)if(typeof e[o]!="function")throw new Error("actions \u91CC\u53EA\u80FD\u653E\u51FD\u6570")}function d(e){if(e===null||typeof e!="object")throw new Error("state \u5FC5\u987B\u662F\u5BF9\u8C61")}function k(e){function o(t,n){let i=e[t];i||(i=e[t]=new Set),i.add(n)}return(t,n)=>{if(Array.isArray(t))for(let i of t)o(i,n);else o(t,n)}}function g(e){function o(t,n){let i=e[t];!i||i.delete(n)}return(t,n)=>{if(Array.isArray(t))for(let i of t)o(i,n);else o(t,n)}}function A(e,o){let{trackStore:t}=e,n=e.state[o],i=t[o];if(!!i)for(let r of i)r(o,n)}function h(e,o){let{state:t,actions:n}=e;return new Proxy(e,{get(i,r){if(r in o)return o[r];if(r in t)return t[r];if(r in n)return n[r];throw new Error(`\u6CA1\u6709\u627E\u5230 ${r}`)},set(i,r,s){if(r in o)throw new Error(`${r} \u662F Store \u81EA\u5E26\u7684\u65B9\u6CD5\u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`);if(r in t)return t[r]=s,!0;throw r in n?new Error(`${r} \u662F actions \u7684\u65B9\u6CD5, \u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`):new Error(`${r} \u8BF7\u5728\u521B\u5EFA Store \u65F6\u6DFB\u52A0\u5230 State \u6216 Actions \u4E2D`)}})}function l(e,o,t=null){let{sameValueExecuteWatch:n}=e.options;return new Proxy(o,{set(i,r,s){return!n&&i[r]===s?!0:S?(i[r]=s,!0):(typeof s=="object"&&s!==null?(f=t||r,i[r]=y(e,s),f=null):i[r]=s,t?A(e,t):A(e,r),!0)}})}function y(e,o,t=!1){let n={};Array.isArray(o)&&(n=[]),S=!0;function i(r,s,u=!1){for(let c in r){let a=r[c];if(u&&(f=c),typeof a=="object"&&a!==null){let I={};Array.isArray(a)&&(I=[]),i(a,I),s[c]=l(e,I,f)}else s[c]=a;u&&(f=null)}}return i(o,n,t),S=!1,t?l(e,n):l(e,n,f)}function j(e,o,t){let n={id:w++,trackStore:{},state:{},actions:o,options:t};return n.state=y(n,e,!0),n}function O(e){let{trackStore:o}=e;return{watch:k(o),deleteWatch:g(o)}}function E(e,o={}){var u,c;let t=(u=e.state)!=null?u:{},n=(c=e.actions)!=null?c:{};d(t),x(n);let i=j(t,n,o),r=O(i);return h(i,r)}export{E as default};
