var w=0,S=!1,u=null;function x(t){for(let n in t)if(typeof t[n]!="function")throw new Error("actions \u91CC\u53EA\u80FD\u653E\u51FD\u6570")}function k(t){if(t===null||typeof t!="object")throw new Error("state \u5FC5\u987B\u662F\u5BF9\u8C61")}function d(t){return(n,o)=>{let r=t[n];r||(r=t[n]=new Set),r.add(o)}}function g(t){return(n,o)=>{let r=t[n];!r||r.delete(o)}}function A(t,n){let{trackStore:o}=t,r=t.state[n],c=o[n];if(!!c)for(let e of c)e(n,r)}function h(t,n){let{state:o,actions:r}=t;return new Proxy(t,{get(c,e){if(e in n)return n[e];if(e in o)return o[e];if(e in r)return r[e];throw new Error(`\u6CA1\u6709\u627E\u5230 ${e}`)},set(c,e,i){if(e in n)throw new Error(`${e} \u662F Store \u81EA\u5E26\u7684\u65B9\u6CD5\u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`);if(e in o)return o[e]=i,!0;throw e in r?new Error(`${e} \u662F actions \u7684\u65B9\u6CD5, \u4E0D\u5141\u8BB8\u88AB\u4FEE\u6539`):new Error(`${e} \u8BF7\u5728\u521B\u5EFA Store \u65F6\u6DFB\u52A0\u5230 State \u6216 Actions \u4E2D`)}})}function l(t,n,o=null){let{sameValueExecuteWatch:r}=t.options;return new Proxy(n,{set(c,e,i){return!r&&c[e]===i?!0:S?(c[e]=i,!0):(typeof i=="object"&&i!==null?(u=o||e,c[e]=y(t,i),u=null):c[e]=i,o?A(t,o):A(t,e),!0)}})}function y(t,n,o=!1){let r={};Array.isArray(n)&&(r=[]),S=!0;function c(e,i,a=!1){for(let s in e){let f=e[s];if(a&&(u=s),typeof f=="object"&&f!==null){let I={};Array.isArray(f)&&(I=[]),c(f,I),i[s]=l(t,I,u)}else i[s]=f;a&&(u=null)}}return c(n,r,o),S=!1,o?l(t,r):l(t,r,u)}function b(t,n,o){let r={id:w++,trackStore:{},state:{},actions:n,options:o};return r.state=y(r,t,!0),r}function j(t){let{trackStore:n}=t;return{watch:d(n),deleteWatch:g(n)}}function O(t,n={}){var a,s;let o=(a=t.state)!=null?a:{},r=(s=t.actions)!=null?s:{};k(o),x(r);let c=b(o,r,n),e=j(c);return h(c,e)}export{O as default};
